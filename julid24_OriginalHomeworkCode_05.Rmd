---
title: "julid24_OriginalHomeworkCode_05"
author: "Julianna D."
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: cerulean
    toc: yes
    toc_float: true
---
# Boostrapping Standard Errors and CIs for Linear Models
> Using bootstrapping, we can estimate standard errors and CIs around regression parameters, such as β coefficients.

## Problem 1
> Using the “KamilarAndCooperData.csv” dataset, run a linear regression looking at log(HomeRange_km2) in relation to log(Body_mass_female_mean) and report your β coeffiecients (slope and intercept).

```{r}
library(curl)
data <- curl("https://raw.githubusercontent.com/fuzzyatelin/fuzzyatelin.github.io/master/AN588_Fall23/KamilarAndCooperData.csv")
kc <- read.csv(data, header = TRUE, stringsAsFactors = FALSE)
attach(kc)
```

```{r}
# Fit the model
# x = log(HomeRange_km2)
# y = log(Body_mass_female_mean)
kc_fit <- lm(log(Body_mass_female_mean)~log(HomeRange_km2))
coef(kc_fit)
```
### Beta Coefficients
> Slope: 0.50638, Intercept: 8.48616

### Plotting the Model
```{r}
library(ggplot2)
ggplot(kc, aes(log(HomeRange_km2), log(Body_mass_female_mean))) +
  geom_point() +
  geom_smooth(method = 'lm', formula=y~x, color = 'purple') +
  labs(
    title = 'Linear Regression',
    x = 'log(HomeRange_km2)',
    y = 'log(Body_mass_female_mean)')
```

## Problem 2
>Then, use bootstrapping to sample from your data 1000 times with replacement, each time fitting the same model and calculating the same coefficients. This generates a sampling distribution for each β coefficient.

```{r}
# Bootstrapping for β coefficients

set <- NULL #dummy variable
n <- 
```


> Estimate the standard error for each of your β coefficients as the standard deviation of the sampling distribution from your bootstrap and determine the 95% CI for each of your β coefficients based on the appropriate quantiles from your sampling distribution.

> How does the former compare to the SE estimated from your entire dataset using the formula for standard error implemented in lm()?

> How does the latter compare to the 95% CI estimated from your entire dataset?


## Extra Credit
> Write a FUNCTION that takes as its arguments a dataframe, “d”, a linear model, “m” (as a character string, e.g., “logHR~logBM”), a user-defined confidence interval level, “conf.level” (with default = 0.95), and a number of bootstrap replicates, “n” (with default = 1000). Your function should return a dataframe that includes: beta coefficient names; beta coefficients, standard errors, and upper and lower CI limits for the linear model based on your entire dataset; and mean beta coefficient estimates, SEs, and CI limits for those coefficients based on your bootstrap.


## Extra Extra Credit
> Graph each beta value from the linear model and its corresponding mean value, lower CI and upper CI from a bootstrap as a function of number of bootstraps from 10 to 200 by 10s. HINT: the beta value from the linear model will be the same for all bootstraps and the mean beta value may not differ that much!
